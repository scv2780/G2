<template>
  <div>
    <h5 class="font-weight-bolder mb-4">ê¸°ê´€ íšŒì› ìƒì„¸ ì •ë³´</h5>

    <!-- ì´ë¦„ -->
    <material-input
      id="name"
      type="text"
      label="ì´ë¦„"
      v-model="name"
      size="lg"
      class="mb-3"
    />

    <!-- ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ (ì•ìë¦¬ + ë’·ìë¦¬) -->
    <div class="d-flex align-items-end gap-2 mb-3">
      <material-input
        id="reg1"
        type="text"
        label="ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ ì•ìë¦¬"
        v-model="regFront"
        size="lg"
        maxlength="6"
        class="flex-grow-1"
      />
      <material-input
        id="reg2"
        type="password"
        label="ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ ë’·ìë¦¬"
        v-model="regBack"
        size="lg"
        maxlength="7"
        class="flex-grow-1"
      />
    </div>

    <!-- ì—°ë½ì²˜ -->
    <material-input
      id="phone"
      type="text"
      label="ì—°ë½ì²˜ ( - ì—†ì´ ì…ë ¥ )"
      v-model="phone"
      size="lg"
      class="mb-3"
    />

    <!-- ì£¼ì†Œ -->
    <div class="d-flex align-items-end gap-2 mb-3">
      <material-input
        id="address"
        type="text"
        label="ì£¼ì†Œ"
        v-model="address"
        size="lg"
        class="flex-grow-1"
      />
      <material-button
        variant="gradient"
        color="success"
        size="md"
        type="button"
        class="py-2 px-3"
        @click="searchAddress"
      >
        ì£¼ì†Œê²€ìƒ‰
      </material-button>
    </div>

    <!-- ê¸°ê´€ëª… -->
    <material-input
      id="orgName"
      type="text"
      label="ê¸°ê´€ëª…"
      v-model="orgName"
      size="lg"
      class="mb-3"
    />

    <!-- ë¶€ì„œëª… -->
    <material-input
      id="department"
      type="text"
      label="ë¶€ì„œëª…"
      v-model="department"
      size="lg"
      class="mb-3"
    />

    <!-- ì§ìœ„ -->
    <material-input
      id="position"
      type="text"
      label="ì§ìœ„"
      v-model="position"
      size="lg"
      class="mb-3"
    />

    <!-- ì´ë©”ì¼ -->
    <div class="d-flex align-items-end gap-2 mb-3">
      <material-input
        id="email"
        type="email"
        label="ì´ë©”ì¼"
        v-model="email"
        size="lg"
        class="flex-grow-1"
      />
      <material-button
        variant="gradient"
        color="success"
        size="md"
        type="button"
        class="py-2 px-3"
        @click="sendVerification"
      >
        ì¸ì¦
      </material-button>
    </div>

    <!-- ì´ë©”ì¼ ì¸ì¦ë²ˆí˜¸ ì…ë ¥ì¹¸ -->
    <div class="d-flex align-items-end gap-2 mb-4" v-if="emailSent">
      <material-input
        id="email-code"
        type="text"
        label="ì¸ì¦ë²ˆí˜¸ ì…ë ¥"
        v-model="verifyCode"
        size="lg"
        class="flex-grow-1"
      />
      <material-button
        variant="gradient"
        color="success"
        size="md"
        type="button"
        class="py-2 px-3"
        @click="verifyEmail"
      >
        ì¸ì¦ ì™„ë£Œ
      </material-button>
    </div>

    <!-- í•˜ë‹¨ ë²„íŠ¼ -->
    <div class="d-flex justify-content-between mt-4">
      <material-button type="button" @click="$emit('back')"
        >ë’¤ë¡œ</material-button
      >
      <material-button type="button" color="success" @click="submitForm">
        íšŒì›ê°€ì… ì™„ë£Œ
      </material-button>
    </div>
  </div>
</template>

<script>
import MaterialInput from '@/components/MaterialInput.vue';
import MaterialButton from '@/components/MaterialButton.vue';

export default {
  name: 'SignUpOrgForm',
  components: { MaterialInput, MaterialButton },
  props: { base: Object },
  data() {
    return {
      name: '',
      regFront: '',
      regBack: '',
      phone: '',
      address: '',
      orgName: '',
      department: '',
      position: '',
      email: '',
      verifyCode: '',
      emailSent: false,
    };
  },
  methods: {
    searchAddress() {
      // ğŸ“ Daum ì£¼ì†Œê²€ìƒ‰ API ì—°ë™ ìœ„ì¹˜
      alert('ì£¼ì†Œ ê²€ìƒ‰ ê¸°ëŠ¥ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.');
    },
    sendVerification() {
      if (!this.email) return alert('ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”.');
      this.emailSent = true;
      alert('ì¸ì¦ë²ˆí˜¸ê°€ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
    },
    verifyEmail() {
      if (!this.verifyCode) return alert('ì¸ì¦ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
      alert('ì´ë©”ì¼ ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
    },
    submitForm() {
      if (!this.name || !this.orgName)
        return alert('ì´ë¦„ê³¼ ê¸°ê´€ëª…ì„ ì…ë ¥í•˜ì„¸ìš”.');

      const payload = {
        name: this.name,
        regNumber: `${this.regFront}-${this.regBack}`,
        phone: this.phone,
        address: this.address,
        orgName: this.orgName,
        department: this.department,
        position: this.position,
        email: this.email,
      };

      this.$emit('submit', payload);
    },
  },
};
</script>
